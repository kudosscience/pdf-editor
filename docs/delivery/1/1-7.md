# 1-7 E2E CoS Test for PBI 1
[Back to task list](./tasks.md)

## Description
Create end-to-end tests that verify PBI 1's Conditions of Satisfaction: opening PDFs, navigating pages, zoom/pan, thumbnails, save/reopen, and offline behavior. Populate `test/fixtures/corpus/` with curated PDF fixtures covering common and edge cases.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-18 18:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements
- **Fixtures:** Provide at least 5 PDFs in `test/fixtures/corpus/`:
  1. `simple-text.pdf` — Single page, Latin text.
  2. `multi-page.pdf` — 10+ pages; mixed text and images.
  3. `cjk-text.pdf` — Chinese/Japanese/Korean characters.
  4. `embedded-images.pdf` — JPEG and PNG images embedded.
  5. `encrypted.pdf` — Password-protected (password: `test123`).
- **E2E scenarios:**
  1. Open `simple-text.pdf`; verify page count = 1; render first page; canvas has non-zero dimensions.
  2. Open `multi-page.pdf`; navigate to last page; verify page indicator matches.
  3. Zoom to 200% on `simple-text.pdf`; verify zoom indicator and canvas size increase.
  4. Open `embedded-images.pdf`; verify thumbnail sidebar shows correct page count.
  5. Open, save, reopen `multi-page.pdf`; verify page count and first-page render match.
  6. Verify no network requests during all scenarios (offline).
  7. Open `encrypted.pdf` with correct password; verify renders; reject wrong password.
- **Framework:** Use Playwright or Spectron for Electron E2E; fall back to manual verification if infra not ready.

## Implementation Plan
1. Curate/create test fixture PDFs and place in `test/fixtures/corpus/`.
2. Set up E2E test framework (Playwright for Electron preferred).
3. Implement test scenarios as individual test cases.
4. Add `npm run test:e2e` script.
5. Document how to run E2E tests locally.

## Test Plan
This task IS the test plan for PBI 1's viewer CoS. All scenarios above must pass.

## Verification
- All 7 E2E scenarios pass.
- Fixtures are committed and loadable.
- Test run completes within 60 seconds.

## Files Modified
- `test/fixtures/corpus/` — Curated PDF fixture files (5+)
- `test/e2e/viewer.test.ts` — E2E test file (new)
- `package.json` — Add test:e2e script and Playwright dev dependency
