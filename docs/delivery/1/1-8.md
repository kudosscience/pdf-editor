# 1-8 Fix scroll offset when canvas exceeds viewport
[Back to task list](./tasks.md)

## Description
Bug fix: when a PDF is rendered at any zoom level that causes the canvas to exceed the viewer container viewport, the vertical scrollbar starts at the top but the top of the PDF is clipped/unreachable. The same issue affects horizontal scrolling. The root cause is `position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%)` on the canvases — this pushes content into negative coordinate space that scrollbars cannot reach.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-19 10:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2026-02-19 10:00:00 | Status Change | Proposed | Agreed | Bug confirmed by user with screenshot | User |
| 2026-02-19 10:00:00 | Status Change | Agreed | InProgress | Started fix | AI_Agent |
| 2026-02-19 10:30:00 | Status Change | InProgress | Review | Fix applied, build succeeds, all 7 E2E tests pass | AI_Agent |

## Requirements
- Scrolling must reach the full extent of the rendered PDF canvas in both axes.
- The canvas must remain centered within the viewport when it is smaller than the viewport.
- No regression in hit-testing, selection overlay, or zoom/fit behaviour.

## Implementation Plan
1. Wrap both canvases (`#page-canvas`, `#overlay-canvas`) in a `<div id="canvas-wrapper">` inside `#viewer-container`.
2. Replace `position: absolute` centering with a CSS Grid `place-items: center` approach on the wrapper, using `min-width: 100%; min-height: 100%` to fill the viewport when the canvas is small.
3. Stack both canvases in the same grid cell (`grid-area: 1 / 1`) so the overlay stays on top.
4. Update JS display-toggle code to show/hide the wrapper instead of individual canvases.

## Test Plan
- Open any multi-page PDF. Zoom to a level where scrollbars appear. Verify the scrollbar at top position shows the top of the PDF.
- Zoom to a level below viewport size. Verify the canvas is centered.
- Confirm hit-testing and selection overlays still align correctly.
- Run existing E2E tests (`npm run test:e2e`) to check for regressions.

## Verification
- Build compiles without errors: ✅
- App launches and renders PDFs: ✅
- All 7 E2E tests pass (`test-results/.last-run.json` → `{"status": "passed", "failedTests": []}`) : ✅
- Canvas centered when smaller than viewport: ✅ (CSS Grid `place-items: center` with `min-width/min-height: 100%`)
- Scrollbar reaches full extent of canvas when larger than viewport: ✅ (no negative-space offset)

## Files Modified
- `src/renderer/index.html` — Wrap canvases in `#canvas-wrapper`
- `src/renderer/styles.css` — Replace absolute centering with CSS Grid wrapper
- `src/renderer/app.ts` — Update display-toggle logic for wrapper
