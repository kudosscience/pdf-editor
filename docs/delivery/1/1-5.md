# 1-5 Canvas viewer UI
[Back to task list](./tasks.md)

## Description
Implement a canvas-based PDF viewer in the renderer with smooth zoom/pan, page navigation, a thumbnail sidebar, drag-drop file opening, and status bar integration. The viewer requests rendered bitmaps from the main process via `window.api.pdf.renderPage()` and displays them on HTML canvas elements.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-18 18:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements
- **Canvas rendering:** Display the current page bitmap on a `<canvas>` element; scale to fit or user-specified zoom.
- **Zoom:** Support zoom in/out (Ctrl+= / Ctrl+-) and fit-to-width/fit-to-page; range 25%–500%.
- **Pan:** Scroll horizontally and vertically when zoomed beyond viewport.
- **Page navigation:** Prev/Next buttons; keyboard PgUp/PgDn; direct page number input; total page indicator.
- **Thumbnails:** Render small-scale bitmaps in the sidebar; highlight current page; click to navigate.
- **Drag-drop:** File drop on viewer opens PDF via `pdf:open`; show visual feedback during dragover.
- **Status bar:** Show current page, total pages, zoom percentage, and dirty state indicator.
- **Loading states:** Show spinner/placeholder while renders are in flight.
- **Error display:** Surface `document:error` events as non-modal status messages.
- **Keyboard shortcuts:** Ctrl+O open, Ctrl+S save, Ctrl+Shift+S save-as, +/- zoom, PgUp/PgDn navigate, Home/End first/last page.

## Implementation Plan
1. Update `src/renderer/index.html` with toolbar zoom/nav controls, canvas element, and thumbnail sidebar structure.
2. Update `src/renderer/styles.css` for canvas container, zoom controls, thumbnail grid, loading states.
3. Implement `PageViewer` class in `src/renderer/app.ts`: manages current page, zoom, requests renders, paints canvas.
4. Implement `ThumbnailPanel` logic: renders thumbnails at low scale, handles click navigation.
5. Wire drag-drop to `pdf:open`; update status bar; handle keyboard events.

## Test Plan
- **Render:** Open test PDF; canvas displays first page; bitmap dimensions match expected.
- **Zoom:** Zoom in/out; canvas updates; zoom percentage in status bar matches.
- **Navigation:** Navigate pages via buttons, keyboard, and thumbnail clicks; page indicator updates.
- **Drag-drop:** Drop PDF file; document opens; drop zone hides.
- **Status bar:** Shows correct page/total/zoom; dirty indicator appears after edits (future).
- **Error:** Trigger `document:error`; status shows error message; no crash.

## Verification
- All navigation paths work (buttons, keyboard, thumbnails).
- Zoom range 25%–500% functions smoothly.
- Drag-drop opens valid PDFs and rejects non-PDF files gracefully.
- Status bar reflects accurate state at all times.

## Files Modified
- `src/renderer/index.html` — Add zoom/nav toolbar controls, canvas element, thumbnail structure
- `src/renderer/styles.css` — Canvas container, zoom controls, thumbnail grid, loading styles
- `src/renderer/app.ts` — PageViewer class, ThumbnailPanel, drag-drop, keyboard, status bar
- `src/renderer/global.d.ts` — Update PdfEditorApi with pdf.* methods
