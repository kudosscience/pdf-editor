# 1-1 App shell and secure IPC
[Back to task list](./tasks.md)

## Description
Set up Electron app shell with main/renderer split, secure preload bridges, TypeScript configuration, and a strict Content Security Policy.

## Status History
| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2026-02-18 12:00:00 | Created | N/A | Proposed | Task file created | User |
| 2026-02-18 12:01:00 | Status Change | Proposed | Agreed | Task approved | User |
| 2026-02-18 16:10:00 | Status Change | Agreed | InProgress | Started implementation | AI_Agent |

## Requirements
- Disable nodeIntegration; use preload for controlled APIs.
- Typed IPC schema with validation; least-privilege channels.
- CSP enforced via response headers and meta tag.
- contextIsolation and sandbox enabled.
- Single instance lock; navigation/window-open prevention.

## Implementation Plan
- Initialize Electron with TS and preload.
- Define IPC contracts and validators in shared/ipc-schema.ts.
- Configure CSP in shared/constants.ts and enforce in main/index.ts.
- Wire file open/save, app lifecycle, and update stubs via IPC handlers.

## Test Plan
- Compilation: TypeScript compiles without errors across all three configs.
- Boot: App window opens with toolbar, workspace, and status bar visible.
- IPC: Open/save dialogs function via secure IPC bridges.
- Security: nodeIntegration disabled; contextIsolation enabled; CSP header present.

## Verification
- App boots with secure IPC and CSP.
- No untyped/unsafe IPC paths; channel allow-list enforced.
- DevTools shows CSP headers in response.

## Files Modified
- package.json — project manifest and dependencies
- tsconfig.main.json, tsconfig.preload.json, tsconfig.renderer.json — TypeScript configs
- src/shared/ipc-schema.ts — IPC channel definitions and validation
- src/shared/constants.ts — App constants and CSP policy
- src/main/index.ts — Main process: window creation, CSP enforcement, navigation lockdown
- src/main/ipc-handlers.ts — IPC handler registration
- src/preload/index.ts — Secure bridge via contextBridge
- src/renderer/index.html — UI shell with CSP meta tag
- src/renderer/styles.css — Application styles
- src/renderer/app.ts — Renderer entry point
- src/renderer/global.d.ts — Type declarations for window.api
- README.md — Project documentation
- .gitignore — Git ignore rules
